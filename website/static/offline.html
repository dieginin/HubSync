<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline - HubSync</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

    <!-- Favicons -->
    <link rel="icon" type="image/png" href="/static/images/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/static/images/favicon.svg" />
    <link rel="shortcut icon" href="/static/images/favicon.ico" />

    <style>
        /* Inline theme styles for offline functionality */
        :root {
            --bs-primary: #248939;
            --text-muted: #636e72;
        }

        [data-bs-theme="dark"] {
            --bs-primary: #4caf50;
            --text-muted: #b0bec5;
        }

        body {
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .btn-primary {
            background-color: var(--bs-primary);
            border-color: var(--bs-primary);
        }

        .btn-primary:hover {
            background-color: #1e7e34;
            border-color: #1e7e34;
        }

        .text-primary {
            color: var(--bs-primary) !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="d-flex align-items-center justify-content-center min-vh-100">
            <div class="text-center">
                <div class="mb-4">
                    <i class="bi bi-wifi-off" style="font-size: 4rem; color: var(--text-muted);"></i>
                </div>

                <h1 class="mb-3">No Internet Connection</h1>

                <p class="text-muted mb-4">
                    Unable to connect to the server at this time.<br>
                    Check your internet connection and try again.
                </p>

                <button class="btn btn-primary" onclick="checkConnectionAndReload()">
                    <i class="bi bi-arrow-clockwise me-2"></i>Retry Connection
                </button>

                <div class="mt-5">
                    <h5 class="mb-3">Suggestions:</h5>
                    <ul class="list-unstyled text-start" style="max-width: 400px; margin: 0 auto;">
                        <li class="mb-2">
                            <i class="bi bi-check-circle text-primary me-2"></i>
                            Check your device is connected to the Internet
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check-circle text-primary me-2"></i>
                            Make sure Wi-Fi or mobile data is enabled
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check-circle text-primary me-2"></i>
                            Try refreshing the page in a few moments
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check-circle text-primary me-2"></i>
                            If the problem persists, contact the administrator
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme detection and application
        function detectAndApplyTheme() {
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const savedTheme = localStorage.getItem('theme');

            let theme = 'light';
            if (savedTheme === 'dark' || (savedTheme === 'auto' && prefersDark) || (!savedTheme && prefersDark)) {
                theme = 'dark';
            }

            document.documentElement.setAttribute('data-bs-theme', theme);
        }

        // Check connection every 5 seconds
        function checkConnection() {
            if (navigator.onLine) {
                // If there's connection, try to reload the original page
                window.location.href = '/';
            }
        }

        // Function for the retry button
        function checkConnectionAndReload() {
            checkConnection();
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        }

        // Initialize theme and connection check
        detectAndApplyTheme();
        checkConnection();

        // Check every 5 seconds
        setInterval(checkConnection, 5000);

        // Listen to connection events
        window.addEventListener('online', () => {
            window.location.href = '/';
        });

        // Listen to theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', detectAndApplyTheme);
    </script>
</body>

</html>